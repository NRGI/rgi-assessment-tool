div.top-padding-lg
    table.table.table-hover
        thead
            tr
                th.col-sm-1 Assessment
                th.col-sm-1 Researcher
                th.col-sm-1 Reviewer
                th.col-sm-1 Assigned
                th.col-sm-1 Started
                th.col-sm-1 Submitted
                th.col-sm-1 Reviewed
                th.col-sm-1 Approve
                th.col-sm-1 Last Edit
                th.col-sm-1 Status
                //th.col-md-1.text-center Questions Complete/Flagged
                th.col-md-1
                th.col-md-1
        tbody
            tr(ng-repeat="assessment in assessments | filter: search_text | orderBy:sort_order")
                //ASSESSMENT
                td.col-sm-1(ng-if="assessment.status=='unassigned'") {{assessment.year}} {{assessment.country}} {{assessment.version}}
                td.col-sm-1(ng-if="assessment.status!='unassigned'")
                    a(
                    href="admin/assessments-admin/{{assessment.assessment_ID}}"
                    ng-if="current_user.isSupervisor()") {{assessment.year}} {{assessment.country}} {{assessment.version}}
                    a(
                    href="assessments/{{assessment.assessment_ID}}"
                    ng-if="!current_user.isSupervisor()") {{assessment.year}} {{assessment.country}} {{assessment.version}}
                //RESEARCHER
                td.col-sm-1(ng-if="assessment.researcher!==undefined")
                    span.glyphicon.glyphicon-pencil(ng-if="assessment.edit_control===assessment.researcher._id && assessment.status!=='submitted' && assessment.status!=='unassigned'")
                    a(href="mailto:{{assessment.researcher.email}}")  {{assessment.researcher.firstName}} {{assessment.researcher.lastName}}
                td.col-sm-1(ng-if="assessment.researcher===undefined") Not assigned
                //REVIEWER
                td.col-sm-1(ng-if="assessment.reviewer!==undefined")
                    span.glyphicon.glyphicon-pencil(ng-if="assessment.edit_control===assessment.reviewer._id && assessment.status!=='submitted' && assessment.status!=='unassigned'")
                    a(href="mailto:{{assessment.reviewer.email}}")  {{assessment.reviewer.firstName}} {{assessment.reviewer.lastName}}
                td.col-sm-1(ng-if="assessment.reviewer===undefined") Not assigned
                //ASSIGNED DATE
                td.col-sm-1
                    i.text-success.glyphicon.glyphicon-calendar.popover-dialog(
                    ng-if="assessment.assignment"
                    popover="{{assessment.assignment.assigned_date | date:'MM/dd/yyyy'}}"
                    popover-trigger="mouseenter")
                    em(ng-if="!assessment.assignment") N/A
                //START DATE
                td.col-sm-1
                    i.text-success.glyphicon.glyphicon-calendar.popover-dialog(
                    ng-if="assessment.start_date"
                    popover="{{assessment.start_date.started_date | date:'MM/dd/yyyy'}}"
                    popover-trigger="mouseenter")
                    em(ng-if="!assessment.start_date") N/A
                //SUBMITTED DATE
                td.col-sm-1
                    i.glyphicon.glyphicon-calendar.popover-dialog(
                    ng-if="assessment.submit_date"
                    popover="{{assessment.submit_date | date:'MM/dd/yyyy'}}"
                    popover-trigger="mouseenter")
                    em.text-center(ng-if="!assessment.submit_date") N/A
                //REVIEWED DATE
                td.col-sm-1
                    i.glyphicon.glyphicon-calendar.popover-dialog(
                    ng-if="assessment.review_date"
                    popover="{{assessment.review_date | date:'MM/dd/yyyy'}}"
                    popover-trigger="mouseenter")
                    em.text-center(ng-if="!assessment.review_date") N/A
                //APPROVED DATE
                td.col-sm-1
                    i.glyphicon.glyphicon-calendar.popover-dialog(
                    ng-if="assessment.approved_date"
                    popover="{{assessment.approved_date | date:'MM/dd/yyyy'}}"
                    popover-trigger="mouseenter")
                    em.text-center(ng-if="!assessment.approved_date") N/A
                //LAST EDIT
                td.col-sm-1(ng-if="assessment.edited_by")
                    a(href="mailto:{{assessment.edited_by.email}}") {{assessment.edited_by.lastName}}
                    text  -
                    em  {{assessment.last_modified.modified_date | date}}
                td.col-sm-1(ng-if="!assessment.edited_by")
                //STATUS
                td.col-sm-1 {{assessment.status | ucfirst}}
                ////QUESTIONS COMPLETE
                //td.col-md-1(ng-if="assessment.questions_complete !== assessment.question_length || assessment.status === 'submitted' || assessment.questions_flagged !== 0") {{assessment.status | ucfirst}}
                //td.col-md-1(ng-if="assessment.status !== 'submitted' && assessment.questions_complete === assessment.question_length && assessment.questions_flagged === 0") Ready to submit
                //QUESTIONS FLAGGED
                //td.text-center.col-md-1
                //    text(ng-if="assessment.status!=='assigned' && assessment.status!=='submitted'") {{assessment.questions_complete}}
                //    text(ng-if="assessment.status==='assigned' || assessment.status==='submitted'")
                //td.text-center.col-md-1
                //    text(ng-if="assessment.status!=='assigned' && assessment.status!=='submitted'") {{assessment.questions_flagged}}
                //    text(ng-if="assessment.status==='assigned' || assessment.status==='submitted'")
                //CONTROL BUTTON 1 -ADMIN
                td.col-sm-1(ng-if="current_user.isSupervisor()")
                    button.btn.btn-col.center-block.btn-primary(
                    ng-click="assignAssessmentDialog(assessment)"
                    ng-if="assessment.status=='unassigned'"
                    ) Assign
                    //TODO add reassign assessment dialog
                    button.btn.btn-col.center-block.btn-warning(
                    ng-click="reassignAssessmentDialog(assessment)"
                    ng-if="assessment.status!='unassigned'"
                    disabled) Reassign
                //CONTROL BUTTON 1 -ADMIN
                td.col-sm-1(ng-if="!current_user.isSupervisor()")
                //CONTROL BUTTON 2 - ADMIN
                td.col-sm-1(ng-if="current_user.isSupervisor()")
                    button.btn.btn-col.btn-primary(
                    ng-click="assessmentStartReview(assessment.assessment_ID)"
                    ng-if="assessment.status === 'submitted'"
                    ) Start Review
                    a.btn.btn-col.center-block.btn-primary(
                    href="/admin/assessments-admin/{{assessment.assessment_ID}}"
                    ng-if="assessment.status=='under_review' || assessment.status === 'resubmitted'"
                    ) Continue review
                    a.btn.btn-col.center-block.btn-primary(
                    href="/admin/assessment-review/{{assessment.assessment_ID}}"
                    ng-if="assessment.status=='approved'"
                    ) Send to external
                    a.btn.center-block.btn-default.disabled(
                    href=""
                    ng-if="assessment.status==='review_researcher' || assessment.status==='review_reviewer'"
                    ) Under review
                    a.btn.center-block.btn-default.disabled(
                    href=""
                    ng-if="assessment.status !=='unassigned' && assessment.status!=='submitted' && assessment.status !== 'resubmitted' && assessment.status!=='under_review' && assessment.status!=='review_researcher' && assessment.status!=='review_reviewer' && assessment.status!=='approved'"
                    ) Waiting for submission
                //CONTROL BUTTON 1 -USER
                td.col-sm-1(ng-if="!current_user.isSupervisor()")
                    //- researcher start button
                    button.btn.btn-col.btn-success(
                    ng-if="assessment.edit_control===current_user._id && (assessment.status === 'assigned' || assessment.status === 'assigned_reviewer' || assessment.status === 'assigned_researcher')"
                    ng-click="assessmentStart(assessment)")
                        text(ng-if="current_user.role==='researcher'") Start assessment
                        text(ng-if="current_user.role==='reviewer'") Start review

                    //- review answers sent back button
                    a.btn.btn-col.center-block.btn-warning(
                    ng-if="(assessment.status === 'review_researcher' || assessment.status === 'review_reviewer') && assessment.edit_control===current_user._id"
                    href="/assessments/{{assessment.assessment_ID}}") Review answers

                    //- disabled for admin review
                    a.btn.btn-col.center-block.btn-default(ng-if="assessment.status === 'submitted' || assessment.status === 'resubmitted' || assessment.status === 'under_review'"
                    href="/assessments/{{assessment.assessment_ID}}"
                    disabled) Under Admin review

                    a.btn.btn-col.center-block.btn-primary(ng-if="assessment.edit_control===current_user._id && (assessment.status === 'started' || assessment.status==='review_started')"
                    href="/assessments/{{assessment.assessment_ID}}") Open assessment

                    a.btn.btn-col.center-block.btn-default(
                    ng-if="assessment.edit_control!==current_user._id"
                    href="/assessments/{{assessment.assessment_ID}}") See answers

                    //TODO add submssion fuction for this page
                    ////- assessment submission
                    //button.btn.btn-success.pull-right(
                    //ng-if="assessment.edit_control===identity.currentUser._id && assessment.questions_complete === assessment.question_length"
                    //ng-click="assessmentSubmit()") Submit assessment

                    ////- disabled for researcher control
                    //a.btn.btn-col.center-block.btn-default(ng-if="(assessment.status === 'assigned_researcher' || assessment.status === 'assigned' || assessment.status === 'started') && current_user.role === 'reviewer'"
                    //href="/assessments-review/{{assessment.assessment_ID}}"
                    //disabled) Under researcher control
                    //
                    ////- disabled for reviewer control
                    //a.btn.btn-col.center-block.btn-default(ng-if="assessment.status === 'assigned_reviewer' && current_user.role === 'researcher'"
                    //href="/assessments-review/{{assessment.assessment_ID}}"
                    //disabled) Under reviewer control
