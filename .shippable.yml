
language: node_js
node_js:
- '0.10'

# include
branches:
  only:
    - master

before_install:
  pip install awsebcli

env:
  global:
    - AWSAccessKeyId=AKIAIDN5JLKAF6E3B4RQ
    - secure: cEtOpX4u4tpX3TdsiuT36gphyjGRzni1bePPhmW9cFOxS26c+O5UkfvcrN3bzHyo2Ji9SylY4V+5f9XkWjbFgXMCclRnFd5XJ44gwyYQktQtGa6oIhfRm51H5rI09hXt3QPErJvEybVEGkbIG8adJj1W+bQdtb6XdKt2+n1IWTU8ZxRk6kagAyiNDrXsslm2qV1NcccryA5ngMJwPnkc5lXzxuYjfLJULjIUjKo+i4CGVGEkkpHRUUnb0SFwgxvNl0oIofT4gMgofmQgNj8cyVBZdj1mgPqGdgXdZp7bXIG4vIfSUQMJOjrAukG3QS5KNUUuhcoS/jk57PR4qqCruA==
    - USER_DEV_ID=cperry
    - secure: AjeKIUuQtBRN+EFpKpR/3/7/bJpvS8ExOdE3/I9k4cblPs+Eh5iV5LJ1Mz1IDzs4uy2nkj7LfPBfA785R/v89qhJYmcka13hjIBuWWilwRa5zeLDQ/98nsKh8DEV4zf+lVElMLpCOqtva2NWolFm7mQQNvTszRJkK1304IE8aEIh/o2Wgi3GOEAY6vDrROfceJ/y/MPSEIsZmX/4CqbHQnqZqWq93E+g/wFzeFTJNbNLKTzM5Oz3uwvsW6Y0LTHbtGQq78Tm0mQWw0pyF4e6iJQ5rLHWPu++bBTaY86H3mUM2hOIidJgZQPMIoV4CrN+7ovnycTWl+CJfAIzW0hQaA==

before_script:
  - mkdir -p ~/.aws
  - echo '[profile eb-cli]' > ~/.aws/config
  - echo $AWSAccessKeyId
  - echo $AWSSecretKeys
  - echo "aws_access_key_id = $AWSAccessKeyId" >> ~/.aws/config
  - echo "aws_secret_access_key = $AWSSecretKey" >> ~/.aws/config
  - npm install phantomjs

script:
  - node_modules/karma/bin/karma start --browsers=PhantomJS --single-run

after_success:
  - eb init && eb deploy rgi-assessment-tool-pr
  - eb setenv USER_DEV_ID=$USER_DEV_ID USER_DEV_KEY=$USER_DEV_KEY

commit_container: byndcivilization/rgi-assessment-tool